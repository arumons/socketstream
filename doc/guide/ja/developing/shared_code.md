### コードの共有

SocketStream の強力な機能の一つに、クライアント／サーバ間で同じ JavaScript/CoffeeScriptコードを共有できることがあげられます。クライアントとサー>バの両方に都度コピーすればもちろん共有できますが、SocketStream はより素晴らしいソリューションを提供します。

共有コードの書き方や名前空間のマッピングはクライアントサイドのコードのそれらと同じですが、共有コードはクライアントとサーバ、両方の環境で動作します。使い方はシンプルで、/app/shared 配下にファイルを追加し、共有したい関数・プロパティ・オブジェクト・CoffeeScriptのクラスなどを export するだけです。

たとえば /app/shared/calculate.coffee というファイルを作成し、次のコードをペーストしてください。

``` coffee-script
exports.circumference = (radius = 1) ->
  2 * estimatePi() * radius

estimatePi = -> 355/113
```

これによってサーバとクライアントの両方から `SS.shared.calculate.circumference(20)` を呼び出せます！/app/shared は計算やフォーマット用ヘルパー、モデルのバリデーションといった処理を書く場所として理想的です。DOM 、バックエンドで動く DB、Node.js のライブラリなど、どちらかの環境だけで動作するような処理は共有しないでください。共有コードはサーバとクライアントの両方で動作する 'ピュア' なコードにしてください。

共有コードは全て事前にロードされ APIツリーの `SS.shared` に追加されるので、サーバやブラウザのコンソールからいつでも呼び出せます。APIツリー上に `estimatePi()` が無いことに気づかれたかもしれません。なぜ無いのかというと、estimatePi() はプライベートで定義されているからです（コード自体はクラ>イアントへ転送されています）。

**注意** /app/shared 内の全てのコードは、最初の接続時に圧縮されてクライアントへ送られます。誰かに見られたら困るコード、データベース／ファイルシ>ステムの呼び出しなどは含めないでください。
